{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\annavarapu.7\\\\Transport-frontend\\\\src\\\\Pages\\\\Schedules\\\\ScheduleTemplateDownload.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport * as XLSX from 'xlsx';\nimport { saveAs } from 'file-saver';\nimport Button from '../../Components/Button';\nimport ToastComponent from '../../Components/Toast';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ScheduleTemplateDownloader = ({\n  setApiProps\n}) => {\n  _s();\n  const {\n    error\n  } = ToastComponent();\n  const [employees, setEmployees] = useState([]);\n  useEffect(() => {\n    if (employees.length === 0) {\n      setApiProps({\n        method: 'GET',\n        url: 'api/employees/all',\n        render: response => {\n          if (response && response.data) {\n            var _response$data;\n            const employeeList = (response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.employees) || (response === null || response === void 0 ? void 0 : response.data) || [];\n            const parsedEmployees = employeeList.map(emp => ({\n              id: emp.employee_id,\n              name: emp.employee_name\n            }));\n            setEmployees(parsedEmployees);\n          } else {\n            error('Response or response.data is undefined');\n          }\n        }\n      });\n    }\n  }, [error]);\n  const handleDownload = () => {\n    const today = new Date();\n    const dateHeaders = [];\n\n    // Push each date twice (for PICKUP and DROP)\n    for (let i = 0; i < 15; i++) {\n      const date = new Date(today);\n      date.setDate(today.getDate() + i);\n\n      // Format date as dd-mm-yyyy with leading zeros\n      const day = String(date.getDate()).padStart(2, '0');\n      const month = String(date.getMonth() + 1).padStart(2, '0');\n      const year = date.getFullYear();\n      const formattedDate = `${day}-${month}-${year}`;\n\n      // Repeat date twice\n      dateHeaders.push(formattedDate, formattedDate);\n    }\n\n    // Header row 1: Dates repeated twice\n    const headerRow1 = ['Employee Id', 'Employee Name', ...dateHeaders];\n\n    // Header row 2: Alternate PICKUP and DROP for each date\n    const headerRow2 = ['', '', ...Array(15).fill(['PICKUP', 'DROP']).flat()];\n\n    // Rows with employee data and empty cells for schedule times\n    const rows = employees.map(emp => {\n      const row = [emp.id, emp.name];\n      for (let i = 0; i < 15 * 2; i++) row.push(''); // 15 dates * 2 columns each\n      return row;\n    });\n    const sheetData = [headerRow1, headerRow2, ...rows];\n    const worksheet = XLSX.utils.aoa_to_sheet(sheetData);\n    const workbook = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(workbook, worksheet, 'Schedule Template');\n    const excelBuffer = XLSX.write(workbook, {\n      bookType: 'xlsx',\n      type: 'array'\n    });\n    const blob = new Blob([excelBuffer], {\n      type: 'application/octet-stream'\n    });\n    saveAs(blob, 'schedule_template.xlsx');\n  };\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    type: \"button\",\n    className: \"notification\",\n    \"data-tooltip\": \"Download Template\",\n    onClick: handleDownload,\n    disabled: employees.length === 0,\n    children: /*#__PURE__*/_jsxDEV(\"img\", {\n      src: process.env.PUBLIC_URL + '/Images/8666778_download_down_save_icon.png',\n      alt: \"hughes\",\n      style: {\n        width: '20px',\n        height: '20px',\n        backgroundColor: 'transparent',\n        border: 'none',\n        cursor: 'pointer'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 14\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 9\n  }, this);\n};\n_s(ScheduleTemplateDownloader, \"/A1Ii8+9z2SDNTFDutGp9pjEZTU=\");\n_c = ScheduleTemplateDownloader;\nexport default ScheduleTemplateDownloader;\nvar _c;\n$RefreshReg$(_c, \"ScheduleTemplateDownloader\");","map":{"version":3,"names":["React","useEffect","useState","useRef","XLSX","saveAs","Button","ToastComponent","jsxDEV","_jsxDEV","ScheduleTemplateDownloader","setApiProps","_s","error","employees","setEmployees","length","method","url","render","response","data","_response$data","employeeList","parsedEmployees","map","emp","id","employee_id","name","employee_name","handleDownload","today","Date","dateHeaders","i","date","setDate","getDate","day","String","padStart","month","getMonth","year","getFullYear","formattedDate","push","headerRow1","headerRow2","Array","fill","flat","rows","row","sheetData","worksheet","utils","aoa_to_sheet","workbook","book_new","book_append_sheet","excelBuffer","write","bookType","type","blob","Blob","className","onClick","disabled","children","src","process","env","PUBLIC_URL","alt","style","width","height","backgroundColor","border","cursor","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/annavarapu.7/Transport-frontend/src/Pages/Schedules/ScheduleTemplateDownload.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\r\nimport * as XLSX from 'xlsx';\r\nimport { saveAs } from 'file-saver';\r\nimport Button from '../../Components/Button';\r\nimport ToastComponent from '../../Components/Toast';\r\n\r\nconst ScheduleTemplateDownloader = ({ setApiProps }) => {\r\n    const { error } = ToastComponent();\r\n    const [employees, setEmployees] = useState([]);\r\n\r\n    useEffect(() => {\r\n        if (employees.length === 0) {\r\n            setApiProps({\r\n                method: 'GET',\r\n                url: 'api/employees/all',\r\n                render: (response) => {\r\n                    if (response && response.data) {\r\n\r\n                        const employeeList = response?.data?.employees || response?.data || [];\r\n                        const parsedEmployees = employeeList.map((emp) => ({\r\n                            id: emp.employee_id,\r\n                            name: emp.employee_name,\r\n                        }));\r\n                        setEmployees(parsedEmployees);\r\n                    } else {\r\n                        error('Response or response.data is undefined');\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }, [error]);\r\n\r\n\r\n    const handleDownload = () => {\r\n        const today = new Date();\r\n        const dateHeaders = [];\r\n\r\n        // Push each date twice (for PICKUP and DROP)\r\n        for (let i = 0; i < 15; i++) {\r\n            const date = new Date(today);\r\n            date.setDate(today.getDate() + i);\r\n\r\n            // Format date as dd-mm-yyyy with leading zeros\r\n            const day = String(date.getDate()).padStart(2, '0');\r\n            const month = String(date.getMonth() + 1).padStart(2, '0');\r\n            const year = date.getFullYear();\r\n\r\n            const formattedDate = `${day}-${month}-${year}`;\r\n\r\n            // Repeat date twice\r\n            dateHeaders.push(formattedDate, formattedDate);\r\n        }\r\n\r\n        // Header row 1: Dates repeated twice\r\n        const headerRow1 = ['Employee Id', 'Employee Name', ...dateHeaders];\r\n\r\n        // Header row 2: Alternate PICKUP and DROP for each date\r\n        const headerRow2 = ['', '', ...Array(15).fill(['PICKUP', 'DROP']).flat()];\r\n\r\n        // Rows with employee data and empty cells for schedule times\r\n        const rows = employees.map(emp => {\r\n            const row = [emp.id, emp.name];\r\n            for (let i = 0; i < 15 * 2; i++) row.push(''); // 15 dates * 2 columns each\r\n            return row;\r\n        });\r\n\r\n        const sheetData = [headerRow1, headerRow2, ...rows];\r\n        const worksheet = XLSX.utils.aoa_to_sheet(sheetData);\r\n        const workbook = XLSX.utils.book_new();\r\n        XLSX.utils.book_append_sheet(workbook, worksheet, 'Schedule Template');\r\n\r\n        const excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });\r\n        const blob = new Blob([excelBuffer], { type: 'application/octet-stream' });\r\n        saveAs(blob, 'schedule_template.xlsx');\r\n    };\r\n\r\n\r\n    return (\r\n        <button\r\n            type=\"button\"\r\n            className='notification'\r\n            data-tooltip=\"Download Template\"\r\n            onClick={handleDownload}\r\n            disabled={employees.length === 0}>            \r\n             <img src={process.env.PUBLIC_URL + '/Images/8666778_download_down_save_icon.png'} alt='hughes' style={{width:'20px', height:'20px', backgroundColor:'transparent', border:'none', cursor:'pointer'}}/>\r\n        </button>\r\n        \r\n    );\r\n};\r\n\r\nexport default ScheduleTemplateDownloader;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}