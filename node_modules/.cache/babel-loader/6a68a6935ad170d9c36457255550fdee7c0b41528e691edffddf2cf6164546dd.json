{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\annavarapu.7\\\\Transport-frontend\\\\src\\\\Components\\\\API.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport Cookies from 'js-cookie';\nimport axios from 'axios';\nimport Loader from './Loader';\nimport ToastComponent from '../Components/Toast';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ApiComponent = ({\n  method,\n  url,\n  postData,\n  render,\n  contentType = 'application/json',\n  onError\n}) => {\n  _s();\n  const {\n    error\n  } = ToastComponent();\n  const [loading, setLoading] = useState(true);\n  const isMountedRef = useRef(true); // avoid triggering useEffect\n\n  useEffect(() => {\n    isMountedRef.current = true;\n    const fetchData = async () => {\n      try {\n        const token = Cookies.get('jwt_token');\n        const endPoint = `http://127.0.0.1:5001/${url}`;\n        const isFormData = postData instanceof FormData;\n        const headers = {\n          'Authorization': `Bearer ${token}`\n        };\n        if (!isFormData) {\n          headers['Content-Type'] = contentType;\n        }\n        const config = {\n          headers\n        };\n        setLoading(true);\n        let response;\n        switch (method) {\n          case 'GET':\n            response = await axios.get(endPoint, config);\n            break;\n          case 'POST':\n            response = await axios.post(endPoint, postData, config);\n            break;\n          case 'PUT':\n            response = await axios.put(endPoint, postData, config);\n            break;\n          case 'DELETE':\n            response = await axios.delete(endPoint, config);\n            break;\n          default:\n            throw new Error(`Unsupported method: ${method}`);\n        }\n        if (isMountedRef.current) {\n          setLoading(false);\n          render(response);\n        }\n      } catch (err) {\n        if (isMountedRef.current) {\n          setLoading(false);\n          if (onError) {\n            onError(err);\n          } else {\n            var _err$response, _err$response$data;\n            error((err === null || err === void 0 ? void 0 : (_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Something went wrong');\n          }\n        }\n      }\n    };\n    fetchData();\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, [method, url, postData, contentType]); // don't include render/onError in deps\n\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 28\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 23\n  }, this);\n  return null;\n};\n_s(ApiComponent, \"AFVY7f7gx6gNW3pRuvSSutWE/mY=\");\n_c = ApiComponent;\nexport default _c2 = /*#__PURE__*/React.memo(ApiComponent);\n\n// import React, { useEffect, useState, useCallback } from 'react';\n// import Cookies from 'js-cookie';\n// import axios from 'axios';\n// import Loader from './Loader'\n// import ToastComponent from '../Components/Toast'\n\n// const ApiComponent = ({ method, url, postData, render }) => {\n//   const { error } = ToastComponent()\n//   const [loading, setLoading] = useState(true);\n//   const [isMounted, setIsMounted] = useState(true); // To handle component unmount\n\n//   const fetchData = useCallback(async () => {\n//     try {\n//       const token = Cookies.get('jwt_token');\n//       const endPoint = `http://127.0.0.1:5001/${url}`;\n//       const config = {\n//         headers: {\n//           'Content-Type': 'application/json',\n//           // 'Content-Type':'multipart/form-data',\n//           'Authorization': `Bearer ${token}`,\n//         },\n//       };\n//       setLoading(true); // Start loading state\n\n//       let response;\n\n//       switch (method) {\n//         case 'GET':\n//           response = await axios.get(endPoint, config);\n//           break;\n//         case 'POST':\n//           response = await axios.post(endPoint, postData, config);\n//           break;\n//         case 'PUT':\n//           response = await axios.put(endPoint, postData, config);\n//           break;\n//         case 'DELETE':\n//           response = await axios.delete(endPoint, config); \n//           break;\n//         default:\n//           throw new Error(`Unsupported method: ${method}`);\n//       }\n\n//       if (isMounted) {    \n//         setLoading(false);   \n//         render(response);\n\n//       }\n//     } catch (err) {\n//       if (isMounted) {\n//         setLoading(false);\n//         error(err?.response?.data?.message)\n\n//       }\n//     }\n//   }, [method, url, postData, render, isMounted]);\n\n//   useEffect(() => {\n//     setIsMounted(true);\n//     fetchData();\n\n//     return () => setIsMounted(false); // Clean up on unmount\n//   }, [fetchData]);\n\n//   if (loading) return <div><Loader /></div>;\n//   // if (error) return <div>Error: {error.message}</div>;\n//   return null;\n// };\n\n// export default React.memo(ApiComponent);\nvar _c, _c2;\n$RefreshReg$(_c, \"ApiComponent\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","useEffect","useState","useRef","Cookies","axios","Loader","ToastComponent","jsxDEV","_jsxDEV","ApiComponent","method","url","postData","render","contentType","onError","_s","error","loading","setLoading","isMountedRef","current","fetchData","token","get","endPoint","isFormData","FormData","headers","config","response","post","put","delete","Error","err","_err$response","_err$response$data","data","message","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","_c2","memo","$RefreshReg$"],"sources":["C:/Users/annavarapu.7/Transport-frontend/src/Components/API.js"],"sourcesContent":["\r\n\r\nimport React, { useEffect, useState, useRef } from 'react';\r\nimport Cookies from 'js-cookie';\r\nimport axios from 'axios';\r\nimport Loader from './Loader';\r\nimport ToastComponent from '../Components/Toast';\r\n\r\nconst ApiComponent = ({ method, url, postData, render, contentType = 'application/json', onError }) => {\r\n  const { error } = ToastComponent();\r\n  const [loading, setLoading] = useState(true);\r\n  const isMountedRef = useRef(true); // avoid triggering useEffect\r\n\r\n  useEffect(() => {\r\n    isMountedRef.current = true;\r\n\r\n    const fetchData = async () => {\r\n      try {\r\n        const token = Cookies.get('jwt_token');\r\n        const endPoint = `http://127.0.0.1:5001/${url}`;\r\n\r\n        const isFormData = postData instanceof FormData;\r\n        const headers = {\r\n          'Authorization': `Bearer ${token}`,\r\n        };\r\n\r\n        if (!isFormData) {\r\n          headers['Content-Type'] = contentType;\r\n        }\r\n\r\n        const config = { headers };\r\n        setLoading(true);\r\n\r\n        let response;\r\n        switch (method) {\r\n          case 'GET':\r\n            response = await axios.get(endPoint, config);\r\n            break;\r\n          case 'POST':\r\n            response = await axios.post(endPoint, postData, config);\r\n            break;\r\n          case 'PUT':\r\n            response = await axios.put(endPoint, postData, config);\r\n            break;\r\n          case 'DELETE':\r\n            response = await axios.delete(endPoint, config);\r\n            break;\r\n          default:\r\n            throw new Error(`Unsupported method: ${method}`);\r\n        }\r\n\r\n        if (isMountedRef.current) {\r\n          setLoading(false);\r\n          render(response);\r\n        }\r\n      } catch (err) {\r\n        if (isMountedRef.current) {\r\n          setLoading(false);\r\n          if (onError) {\r\n            onError(err);\r\n          } else {\r\n            error(err?.response?.data?.message || 'Something went wrong');\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n\r\n    return () => {\r\n      isMountedRef.current = false;\r\n    };\r\n  }, [method, url, postData, contentType]); // don't include render/onError in deps\r\n\r\n  if (loading) return <div><Loader /></div>;\r\n\r\n  return null;\r\n};\r\n\r\nexport default React.memo(ApiComponent);\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// import React, { useEffect, useState, useCallback } from 'react';\r\n// import Cookies from 'js-cookie';\r\n// import axios from 'axios';\r\n// import Loader from './Loader'\r\n// import ToastComponent from '../Components/Toast'\r\n\r\n// const ApiComponent = ({ method, url, postData, render }) => {\r\n//   const { error } = ToastComponent()\r\n//   const [loading, setLoading] = useState(true);\r\n//   const [isMounted, setIsMounted] = useState(true); // To handle component unmount\r\n\r\n//   const fetchData = useCallback(async () => {\r\n//     try {\r\n//       const token = Cookies.get('jwt_token');\r\n//       const endPoint = `http://127.0.0.1:5001/${url}`;\r\n//       const config = {\r\n//         headers: {\r\n//           'Content-Type': 'application/json',\r\n//           // 'Content-Type':'multipart/form-data',\r\n//           'Authorization': `Bearer ${token}`,\r\n//         },\r\n//       };\r\n//       setLoading(true); // Start loading state\r\n\r\n//       let response;\r\n\r\n//       switch (method) {\r\n//         case 'GET':\r\n//           response = await axios.get(endPoint, config);\r\n//           break;\r\n//         case 'POST':\r\n//           response = await axios.post(endPoint, postData, config);\r\n//           break;\r\n//         case 'PUT':\r\n//           response = await axios.put(endPoint, postData, config);\r\n//           break;\r\n//         case 'DELETE':\r\n//           response = await axios.delete(endPoint, config); \r\n//           break;\r\n//         default:\r\n//           throw new Error(`Unsupported method: ${method}`);\r\n//       }\r\n\r\n//       if (isMounted) {    \r\n//         setLoading(false);   \r\n//         render(response);\r\n        \r\n//       }\r\n//     } catch (err) {\r\n//       if (isMounted) {\r\n//         setLoading(false);\r\n//         error(err?.response?.data?.message)\r\n        \r\n//       }\r\n//     }\r\n//   }, [method, url, postData, render, isMounted]);\r\n\r\n//   useEffect(() => {\r\n//     setIsMounted(true);\r\n//     fetchData();\r\n\r\n//     return () => setIsMounted(false); // Clean up on unmount\r\n//   }, [fetchData]);\r\n\r\n//   if (loading) return <div><Loader /></div>;\r\n//   // if (error) return <div>Error: {error.message}</div>;\r\n//   return null;\r\n// };\r\n\r\n// export default React.memo(ApiComponent);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}