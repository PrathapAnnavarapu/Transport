{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\annavarapu.7\\\\Transport-frontend\\\\src\\\\Pages\\\\Schedules\\\\DropGroupingSchedules.js\",\n  _s = $RefreshSig$();\nimport React, { useCallback, useEffect, useState, useRef } from 'react';\nimport ApiComponent from '../../Components/API';\nimport DatePicker from 'react-datepicker';\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\nimport { FaPlus, FaArrowRight } from 'react-icons/fa';\nimport { IoCheckmarkCircleOutline } from 'react-icons/io5';\nimport TimePicker from 'react-time-picker';\nimport Dropdown from '../../Components/Dropdown';\nimport ClusterMapModal from '../../Components/ClusterMapModel';\nimport ToastComponent from '../../Components/Toast';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport 'react-time-picker/dist/TimePicker.css';\nimport 'leaflet/dist/leaflet.css';\nimport { TrendingUp, TrendingDown, DollarSign, Users, FileText, CheckCircle, Bus } from 'lucide-react';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst StatsCard = ({\n  label,\n  value,\n  icon,\n  color,\n  footer,\n  trend\n}) => /*#__PURE__*/_jsxDEV(\"div\", {\n  className: \"stats-card\",\n  children: /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"card-top\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"card-label\",\n        children: label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 29,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"card-value\",\n        children: value\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 30,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `icon-container ${color}`,\n      children: icon\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 27,\n    columnNumber: 9\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 26,\n  columnNumber: 5\n}, this);\n_c = StatsCard;\nconst DropGroupingSchedules = () => {\n  _s();\n  const {\n    info,\n    error,\n    success\n  } = ToastComponent();\n  const [manualClusters, setManualClusters] = useState({});\n  const [selectedDate, setSelectedDate] = useState(() => new Date());\n  const [apiProps, setApiProps] = useState(null);\n  const [editable, setEditable] = useState({});\n  const [vechilesList, setVechileList] = useState([]);\n  const [mapClusterData, setMapClusterData] = useState(null);\n  const [routingStatus, setRoutingStatus] = useState({});\n  const prevManualClustersRef = useRef();\n  useEffect(() => {\n    const prevManualClusters = prevManualClustersRef.current;\n    if (prevManualClusters && JSON.stringify(prevManualClusters) !== JSON.stringify(manualClusters)) {\n      const groupedByDate = new Map(); // Map<shiftDate, Set<pickupTime>>\n\n      Object.entries(manualClusters).forEach(([dropTime, clusters]) => {\n        Object.entries(clusters).forEach(([clusterId, cluster]) => {\n          var _employeeList$;\n          const employeeList = cluster.employeeList;\n          const shiftDate = employeeList && ((_employeeList$ = employeeList[0]) === null || _employeeList$ === void 0 ? void 0 : _employeeList$.shift_date);\n          if (shiftDate) {\n            if (!groupedByDate.has(shiftDate)) {\n              groupedByDate.set(shiftDate, new Set());\n            }\n            groupedByDate.get(shiftDate).add(dropTime);\n          }\n        });\n      });\n\n      // Send one request per shift date with all its pickup times\n      groupedByDate.forEach((dropTimesSet, shiftDate) => {\n        const dropTimes = Array.from(dropTimesSet);\n        fetchRoutingDetails(dropTimes, shiftDate);\n      });\n    }\n    prevManualClustersRef.current = manualClusters;\n  }, [manualClusters]);\n  const fetchRoutingDetails = (dropTimes, shiftDate) => {\n    setApiProps({\n      method: 'POST',\n      url: 'api/get/drop/routing-details',\n      postData: JSON.stringify({\n        drop_time: dropTimes,\n        // Now an array\n        shift_date: shiftDate\n      }),\n      render: detailsResponse => {\n        if (detailsResponse.status === 200 && Array.isArray(detailsResponse.data.data)) {\n          // Filter for both 'Routing Done', 'Picked Up', and 'Completed' statuses\n          const allRoutingData = detailsResponse.data.data.filter(item => item.routing && ['Routing Done', 'Picked Up', 'Completed'].includes(item.routing.drop_trip_status));\n          if (allRoutingData.length > 0) {\n            setManualClusters(prevManualClusters => {\n              const updatedClusters = {\n                ...prevManualClusters\n              };\n              const newRoutingStatus = {};\n              const clustersToRemove = new Set(); // To track clusters to be removed\n\n              allRoutingData.forEach(item => {\n                var _item$vehicle, _item$vehicle2, _item$vehicle3;\n                const group = item.schedule.drop_time; // drop_time is the group\n                const clusterId = item.cluster_id;\n                const vehicleNumber = (item === null || item === void 0 ? void 0 : (_item$vehicle = item.vehicle) === null || _item$vehicle === void 0 ? void 0 : _item$vehicle.vechile_number) || null;\n                const vechile_id = (item === null || item === void 0 ? void 0 : (_item$vehicle2 = item.vehicle) === null || _item$vehicle2 === void 0 ? void 0 : _item$vehicle2.vechile_id) || null;\n                const vehicleOwnerName = (item === null || item === void 0 ? void 0 : (_item$vehicle3 = item.vehicle) === null || _item$vehicle3 === void 0 ? void 0 : _item$vehicle3.vechile_owner_name) || null;\n                const employeeList = item.employeeList || []; // Assuming the employee list is in the API response\n                const status = item.routing.drop_trip_status; // Either 'Routing Done', 'Picked Up', or 'Completed'\n\n                // Check if the cluster and group already exist in the state\n                if (updatedClusters[group] && updatedClusters[group][clusterId]) {\n                  const currentCluster = updatedClusters[group][clusterId];\n\n                  // Add vehicle details if they are not already set\n                  if (vehicleNumber && (!currentCluster.vehicleDetails || currentCluster.vehicleDetails.vechile_number !== vehicleNumber)) {\n                    currentCluster.vehicleDetails = {\n                      vechile_number: vehicleNumber,\n                      vechile_owner_name: vehicleOwnerName,\n                      vechile_id: vechile_id\n                    };\n                  }\n\n                  // Replace the current employees with the new employeeList\n                  if (Array.isArray(employeeList) && employeeList.length > 0) {\n                    currentCluster.employees = employeeList; // Replace employees with employeeList from the API\n                  }\n\n                  // Set routing status to either 'completed' or 'routing done', or 'Trip in progress' for 'Picked Up'\n                  if (status === 'Completed') {\n                    newRoutingStatus[`${group}__${clusterId}`] = 'completed';\n                  } else if (status === 'Picked Up') {\n                    newRoutingStatus[`${group}__${clusterId}`] = 'Trip in progress'; // Update here\n                  } else {\n                    newRoutingStatus[`${group}__${clusterId}`] = 'routing done';\n                  }\n\n                  // If the status is 'Completed', we need to mark this cluster for removal\n                  if (status === 'Completed') {\n                    clustersToRemove.add(`${group}__${clusterId}`);\n                  }\n                }\n              });\n\n              // Remove the clusters that are marked for removal\n              clustersToRemove.forEach(clusterKey => {\n                const [dropTime, clusterId] = clusterKey.split('__');\n                if (updatedClusters[dropTime] && updatedClusters[dropTime][clusterId]) {\n                  delete updatedClusters[dropTime][clusterId];\n\n                  // If the pickup group has no clusters left, delete the entire pickup group\n                  if (Object.keys(updatedClusters[dropTime]).length === 0) {\n                    delete updatedClusters[dropTime];\n                  }\n                }\n              });\n\n              // Filter out any pickup groups that are empty (i.e., they don't have any clusters after removal)\n              Object.keys(updatedClusters).forEach(group => {\n                if (Object.keys(updatedClusters[group]).length === 0) {\n                  delete updatedClusters[group]; // Remove the empty pickup group\n                }\n              });\n\n              // Update routing status\n              setRoutingStatus(prev => ({\n                ...prev,\n                ...newRoutingStatus\n              }));\n\n              // Return the updated clusters after filtering out empty groups\n              return updatedClusters;\n            });\n          } else {\n            // Handle case where no routing data is available\n            // info('No routing data found for the selected date.');\n          }\n        } else {\n          error(\"Failed to fetch routing details.\");\n        }\n      }\n    });\n  };\n\n  // Fetch schedules on date change\n  useEffect(() => {\n    if (selectedDate) {\n      fetchSchedules(selectedDate, () => {\n        fetchVehicleList();\n      });\n    }\n  }, [selectedDate]);\n  const fetchSchedules = (date, onComplete) => {\n    const formattedDate = date.toISOString().split('T')[0];\n    setApiProps({\n      method: 'POST',\n      url: 'api/get/drop/clustered-routes',\n      postData: {\n        date: formattedDate\n      },\n      render: response => {\n        const optimizedRoutes = response.data.optimized_routes || [];\n        const initialClusters = {};\n        optimizedRoutes.forEach(route => {\n          const dropTime = route.drop_time_group;\n          const clusters = {};\n          route.clusters.forEach((cl, idx) => {\n            clusters[`cluster${idx + 1}`] = {\n              employeeList: cl.drop_sequence,\n              routeName: cl.route_name,\n              vehicleDetails: null\n            };\n          });\n          initialClusters[dropTime] = clusters;\n        });\n        setManualClusters(initialClusters);\n        setRoutingStatus({});\n        if (onComplete) onComplete(); // Trigger next step\n      }\n    });\n  };\n\n  // Fetch vehicle list\n  const fetchVehicleList = () => {\n    if (vechilesList.length === 0) {\n      setApiProps({\n        method: 'GET',\n        url: 'api/get/vechile/all',\n        render: response => {\n          if (response) {\n            setVechileList(response.data);\n          } else {\n            console.error('No response received from API');\n          }\n        },\n        onError: error => {\n          console.error('Error fetching vehicles:', error);\n        }\n      });\n    }\n  };\n\n  // Save cluster changes\n  const saveClusterChanges = (dropTime, clusterId, empIndex) => {\n    var _cluster$employeeList;\n    const cluster = manualClusters[dropTime][clusterId];\n    if (!cluster) {\n      console.error(\"Cluster not found.\");\n      return;\n    }\n    const shiftDate = (_cluster$employeeList = cluster.employeeList[0]) === null || _cluster$employeeList === void 0 ? void 0 : _cluster$employeeList.shift_date;\n    const employee = cluster.employeeList[empIndex];\n    if (!employee) {\n      console.error('Employee not found at the given index');\n      return;\n    }\n\n    // Update the relevant employee's details\n    cluster.employeeList[empIndex] = {\n      ...employee,\n      drop_sequence: employee.drop_sequence,\n      // (if modified)\n      calculated_drop_time: employee.calculated_drop_time,\n      // (if modified)\n      distance_from_last: employee.distance_from_last || 0,\n      // Handle undefined\n      cumulative_distance: employee.cumulative_distance || 0 // Handle undefined\n    };\n    const payload = {\n      clusters: manualClusters,\n      date: shiftDate\n    };\n    setApiProps({\n      method: 'PUT',\n      url: `api/get/drop/updated/manual-clustered-details/${employee.employee_id}/${employee.schedule_id}`,\n      postData: JSON.stringify(payload),\n      // Ensure the payload is stringified\n      render: response => {\n        if (response.status === 200) {\n          success(\"Changes saved successfully.\");\n          fetchRoutingDetails([dropTime], shiftDate);\n        } else {\n          error((response === null || response === void 0 ? void 0 : response.message) || \"Failed to save changes.\");\n        }\n      }\n    });\n  };\n\n  // Add a new cluster to the drop time\n  const addNewCluster = dropTime => {\n    setManualClusters(prev => {\n      const current = prev[dropTime] || {};\n      const newClusterId = `cluster${Object.keys(current).length + 1}`;\n      return {\n        ...prev,\n        [dropTime]: {\n          ...current,\n          [newClusterId]: {\n            employeeList: [],\n            vehicleDetails: null\n          }\n        }\n      };\n    });\n  };\n\n  // Handle \"Optimize Routing\" button click\n  const handleProceed = useCallback((dropTime, clusterId) => {\n    const cluster = manualClusters[dropTime][clusterId];\n    if (!cluster.vehicleDetails) {\n      ToastComponent().error(\"Please select a vehicle\");\n      return;\n    }\n    const postCluster = {\n      [dropTime]: [{\n        ...cluster,\n        clusterId: clusterId\n      }]\n    };\n    setApiProps({\n      method: 'POST',\n      url: 'api/get/drop-routing',\n      postData: JSON.stringify(postCluster),\n      render: response => {\n        var _cluster$employeeList2;\n        const result = response.data;\n        if (!result || !result.route || !Array.isArray(result.route)) {\n          console.error(\"Invalid response format: 'route' array not found\", result);\n          error(\"Failed to update routing. Invalid response format.\");\n          return;\n        }\n        const updated = {\n          ...manualClusters\n        };\n        const newRoute = result.route.find(r => r.drop_time_group === dropTime);\n        if (newRoute) {\n          newRoute.clusters.forEach((cl, idx) => {\n            const clusterKey = Object.keys(updated[dropTime])[idx] || `cluster${idx + 1}`;\n            updated[dropTime][clusterKey].employeeList = cl.drop_sequence;\n            const tripStatus = cl.trip_status;\n            if (tripStatus) {\n              setRoutingStatus(prev => ({\n                ...prev,\n                [`${dropTime}__${clusterKey}`]: tripStatus\n              }));\n            }\n\n            // saveClusterChanges(dropTime, clusterKey);\n          });\n        }\n        setManualClusters(updated);\n\n        // âœ… Get shift_date from first employee in the cluster\n        const shiftDate = (_cluster$employeeList2 = cluster.employeeList[0]) === null || _cluster$employeeList2 === void 0 ? void 0 : _cluster$employeeList2.shift_date;\n        if (shiftDate) {\n          fetchRoutingDetails([dropTime], shiftDate); // Send as list\n        } else {\n          console.warn(\"Shift date not found in cluster data\");\n        }\n      }\n    });\n  }, [manualClusters, success, error, info]);\n\n  // Handle drag-and-drop behavior\n  const onDragEnd = result => {\n    const {\n      source,\n      destination\n    } = result;\n    if (!destination || source.droppableId === destination.droppableId && source.index === destination.index) return;\n    const [sourceTime, sourceCluster] = source.droppableId.split('__');\n    const [destTime, destCluster] = destination.droppableId.split('__');\n    if (sourceTime !== destTime) return;\n    const sourceItems = Array.from(manualClusters[sourceTime][sourceCluster].employeeList);\n    const destItems = Array.from(manualClusters[destTime][destCluster].employeeList);\n    const [movedItem] = sourceItems.splice(source.index, 1);\n\n    // Prevent moving an employee if they already exist in the destination\n    if (destItems.some(emp => emp.employee_id === movedItem.employee_id)) return;\n\n    // Move the item to the destination\n    destItems.splice(destination.index, 0, movedItem);\n\n    // Update the clusters with the new data\n    const updatedClusters = {\n      ...manualClusters,\n      [sourceTime]: {\n        ...manualClusters[sourceTime],\n        [sourceCluster]: {\n          ...manualClusters[sourceTime][sourceCluster],\n          employeeList: sourceItems\n        },\n        [destCluster]: {\n          ...manualClusters[destTime][destCluster],\n          employeeList: destItems\n        }\n      }\n    };\n\n    // Remove any empty clusters before sending the data to the API\n    Object.keys(updatedClusters[sourceTime]).forEach(cluster => {\n      if (updatedClusters[sourceTime][cluster].employeeList.length === 0) {\n        delete updatedClusters[sourceTime][cluster];\n      }\n    });\n    Object.keys(updatedClusters[destTime]).forEach(cluster => {\n      if (updatedClusters[destTime][cluster].employeeList.length === 0) {\n        delete updatedClusters[destTime][cluster];\n      }\n    });\n    setManualClusters(updatedClusters);\n\n    // Update routing status\n    setRoutingStatus(prev => ({\n      ...prev,\n      [`${sourceTime}__${sourceCluster}`]: false,\n      [`${destTime}__${destCluster}`]: false\n    }));\n    const shiftDate = (movedItem === null || movedItem === void 0 ? void 0 : movedItem.shift_date) || new Date().toISOString().split(\"T\")[0];\n    const isoDate = `${shiftDate}T${sourceTime}`;\n    const payload = {\n      clusters: updatedClusters,\n      date: isoDate // Correct ISO 8601 format\n    };\n\n    // Call the API to save the updated clusters\n    setApiProps({\n      method: 'POST',\n      url: 'api/get/drop/updated/manual-clustered-routes',\n      postData: JSON.stringify(payload),\n      // Ensure payload is stringified\n      render: response => {\n        if (response.status === 200) {\n          success(\"Saved successfully.\");\n          fetchSchedules(shiftDate);\n        } else {\n          error((response === null || response === void 0 ? void 0 : response.message) || \"Failed to save changes.\");\n        }\n      }\n    });\n  };\n\n  // Update employee values\n  const updateEmployeeValue = (dropTime, clusterId, empIndex, key, value) => {\n    setManualClusters(prev => {\n      const updated = {\n        ...prev\n      };\n      const cluster = [...updated[dropTime][clusterId].employeeList];\n      cluster[empIndex][key] = value;\n      updated[dropTime][clusterId].employeeList = cluster;\n      return updated;\n    });\n  };\n  const toggleEdit = (dropTime, clusterId, empIndex) => {\n    const key = `${dropTime}__${clusterId}__${empIndex}`;\n    const wasEditing = editable[key];\n    setEditable(prev => ({\n      ...prev,\n      [key]: !prev[key]\n    }));\n    if (wasEditing === true) {\n      saveClusterChanges(dropTime, clusterId, empIndex);\n    }\n  };\n  const getValidTime = timeStr => {\n    if (!timeStr || typeof timeStr !== 'string') return '00:00';\n    const match = timeStr.match(/^(\\d{2}):(\\d{2})/);\n    return match ? match[0] : '00:00';\n  };\n  const totalRoutes = Object.keys(manualClusters).reduce((acc, dropTime) => {\n    return acc + Object.keys(manualClusters[dropTime]).length;\n  }, 0);\n  const totalEmployees = Object.values(manualClusters).reduce((acc, clusters) => {\n    return acc + Object.values(clusters).reduce((clusterAcc, clusterData) => {\n      var _clusterData$employee;\n      return clusterAcc + ((clusterData === null || clusterData === void 0 ? void 0 : (_clusterData$employee = clusterData.employeeList) === null || _clusterData$employee === void 0 ? void 0 : _clusterData$employee.length) || 0);\n    }, 0);\n  }, 0);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"pick-grouping-main-container\",\n    children: [apiProps && /*#__PURE__*/_jsxDEV(ApiComponent, {\n      ...apiProps\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 509,\n      columnNumber: 26\n    }, this), mapClusterData && /*#__PURE__*/_jsxDEV(ClusterMapModal, {\n      clusterData: mapClusterData,\n      onClose: () => setMapClusterData(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 510,\n      columnNumber: 32\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grouping-schediles-with-datepicker-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Drop Schedules\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 512,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(DatePicker, {\n        selected: selectedDate,\n        onChange: date => {\n          if (date) setSelectedDate(date);\n        },\n        className: \"date-range-picker\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 513,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(DragDropContext, {\n      onDragEnd: onDragEnd,\n      children: Object.keys(manualClusters).length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"no-schedules-message\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/Images/897245_clock_manage_schedule_time_icon.png\",\n          alt: \"schedule\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 522,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"No schedules available.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 521,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grouped-schedules-list\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stats-grid\",\n          children: [/*#__PURE__*/_jsxDEV(StatsCard, {\n            label: \"Total Routes\",\n            value: totalRoutes,\n            icon: /*#__PURE__*/_jsxDEV(Bus, {\n              className: \"icon green\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 531,\n              columnNumber: 39\n            }, this),\n            color: \"green-bg\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 528,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(StatsCard, {\n            label: \"Total Employees\",\n            value: totalEmployees,\n            icon: /*#__PURE__*/_jsxDEV(Users, {\n              className: \"icon blue\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 537,\n              columnNumber: 39\n            }, this),\n            color: \"green-bg\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 534,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 527,\n          columnNumber: 25\n        }, this), Object.entries(manualClusters).sort(([timeA], [timeB]) => {\n          const tA = timeA.padStart(5, '0');\n          const tB = timeB.padStart(5, '0');\n          return tA.localeCompare(tB);\n        }).map(([dropTime, clusters]) => {\n          const totalRoutes = Object.keys(clusters).length;\n          const totalEmployees = Object.values(clusters).reduce((total, clusterData) => {\n            var _clusterData$employee2;\n            return total + ((clusterData === null || clusterData === void 0 ? void 0 : (_clusterData$employee2 = clusterData.employeeList) === null || _clusterData$employee2 === void 0 ? void 0 : _clusterData$employee2.length) || 0);\n          }, 0);\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"pickuptime-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"pickuptime-with-actions\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: [\"Drop Time: \", dropTime]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 559,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                children: [\"Total Routes: \", totalRoutes]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 560,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n                children: [\"Total Employees: \", totalEmployees]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 561,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => addNewCluster(dropTime),\n                className: \"add-cluster-btn\",\n                children: [/*#__PURE__*/_jsxDEV(FaPlus, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 562,\n                  columnNumber: 121\n                }, this), \" Add Cluster\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 562,\n                columnNumber: 45\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 558,\n              columnNumber: 41\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"clusters-container\",\n              children: Object.entries(clusters).map(([clusterId, clusterData]) => {\n                const employeeList = (clusterData === null || clusterData === void 0 ? void 0 : clusterData.employeeList) || [];\n                const routeName = (clusterData === null || clusterData === void 0 ? void 0 : clusterData.routeName) || '';\n                const vehicleDetails = clusterData === null || clusterData === void 0 ? void 0 : clusterData.vehicleDetails;\n                const isOptimized = routingStatus[`${dropTime}__${clusterId}`];\n                return /*#__PURE__*/_jsxDEV(Droppable, {\n                  droppableId: `${dropTime}__${clusterId}`,\n                  children: provided => /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"cluster-card\",\n                    ref: provided.innerRef,\n                    ...provided.droppableProps,\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"cluster-card-with-vechile\",\n                      children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                        children: clusterId\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 576,\n                        columnNumber: 69\n                      }, this), isOptimized ? routingStatus[`${dropTime}__${clusterId}`] === 'Trip in progress' ? /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"trip-in-progress\",\n                        children: \"Trip Started\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 579,\n                        columnNumber: 77\n                      }, this) : /*#__PURE__*/_jsxDEV(IoCheckmarkCircleOutline, {\n                        className: \"optimized-check-icon\",\n                        size: 20,\n                        color: \"green\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 581,\n                        columnNumber: 77\n                      }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                        onClick: () => handleProceed(dropTime, clusterId),\n                        className: \"optimize-routing-btn\",\n                        children: [/*#__PURE__*/_jsxDEV(FaArrowRight, {}, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 585,\n                          columnNumber: 77\n                        }, this), \" Assign Vehicle\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 584,\n                        columnNumber: 73\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 575,\n                      columnNumber: 65\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"cluster-card-with-vechile\",\n                      children: [/*#__PURE__*/_jsxDEV(Dropdown, {\n                        options: ['', ...vechilesList.map(option => `${option.vechile_number} - ${option.vechile_owner_name}`)],\n                        className: \"vechile-dropdown\",\n                        htmlFor: \"vechile\",\n                        id: \"vechile\",\n                        label: \"\",\n                        value: vehicleDetails ? `${vehicleDetails.vechile_number} - ${vehicleDetails.vechile_owner_name}` : '',\n                        onChange: e => {\n                          const selectedValue = e.target.value.trim();\n                          if (selectedValue === '') {\n                            setManualClusters(prev => ({\n                              ...prev,\n                              [dropTime]: {\n                                ...prev[dropTime],\n                                [clusterId]: {\n                                  ...prev[dropTime][clusterId],\n                                  vehicleDetails: null\n                                }\n                              }\n                            }));\n                            return;\n                          }\n                          const selectedVehicle = vechilesList.find(v => `${v.vechile_number} - ${v.vechile_owner_name}` === selectedValue);\n                          if (selectedVehicle && (!vehicleDetails || selectedVehicle.vechile_id !== vehicleDetails.vechile_id)) {\n                            setManualClusters(prev => ({\n                              ...prev,\n                              [dropTime]: {\n                                ...prev[dropTime],\n                                [clusterId]: {\n                                  ...prev[dropTime][clusterId],\n                                  vehicleDetails: selectedVehicle\n                                }\n                              }\n                            }));\n                            const payload = employeeList.map(employee => ({\n                              vehicle_id: selectedVehicle.id,\n                              employee_id: employee.employee_id,\n                              schedule_id: employee.schedule_id\n                            }));\n                            if (payload.length === 0) {\n                              console.error('No employees in the cluster.');\n                              return;\n                            }\n                            setApiProps({\n                              method: 'POST',\n                              url: 'api/update/drop-vehicles',\n                              postData: JSON.stringify(payload),\n                              render: response => {\n                                if (response.status === 200) {\n                                  var _employeeList$2;\n                                  success(\"Vehicles updated for all employees in the cluster.\");\n                                  fetchRoutingDetails([dropTime], (_employeeList$2 = employeeList[0]) === null || _employeeList$2 === void 0 ? void 0 : _employeeList$2.shift_date);\n                                } else {\n                                  error((response === null || response === void 0 ? void 0 : response.message) || \"Failed to update vehicles.\");\n                                }\n                              }\n                            });\n                          }\n                        },\n                        onFocus: e => {\n                          const currentValue = e.target.value;\n                          e.target.value = '';\n                          setTimeout(() => {\n                            e.target.value = currentValue;\n                          }, 0);\n                        },\n                        placeholder: \"Vehicle No\",\n                        name: \"vechileNo\",\n                        dropDownList: \"vechilesList\",\n                        disabled: !editable[`${dropTime}__${clusterId}`]\n                      }, vechilesList.map(option => option.vechile_id).join('-'), false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 590,\n                        columnNumber: 69\n                      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                        onClick: () => setMapClusterData(employeeList),\n                        disabled: employeeList.length === 0,\n                        className: \"view-map-button\",\n                        children: \"Map\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 661,\n                        columnNumber: 69\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 589,\n                      columnNumber: 65\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"cluster-route-info\",\n                      children: /*#__PURE__*/_jsxDEV(\"h6\", {\n                        children: [\"Route Name : \", /*#__PURE__*/_jsxDEV(\"span\", {\n                          children: routeName\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 664,\n                          columnNumber: 86\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 664,\n                        columnNumber: 69\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 663,\n                      columnNumber: 65\n                    }, this), employeeList.length === 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => {\n                        const updated = {\n                          ...manualClusters\n                        };\n                        delete updated[dropTime][clusterId];\n                        setManualClusters(updated);\n                      },\n                      className: \"remove-cluster-btn\",\n                      children: \"\\u2715\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 667,\n                      columnNumber: 69\n                    }, this), employeeList.map((emp, idx) => {\n                      const editKey = `${dropTime}__${clusterId}__${idx}`;\n                      return /*#__PURE__*/_jsxDEV(Draggable, {\n                        draggableId: emp.employee_id,\n                        index: idx,\n                        children: provided => /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: \"employee-card\",\n                          ref: provided.innerRef,\n                          ...provided.draggableProps,\n                          ...provided.dragHandleProps,\n                          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                            children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                              children: emp.employee_name || 'Unnamed'\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 679,\n                              columnNumber: 88\n                            }, this)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 679,\n                            columnNumber: 85\n                          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                              src: \"/Images/5172573_location_map_icon.png\",\n                              className: \"location-icon\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 680,\n                              columnNumber: 88\n                            }, this), emp.employee_address || 'No address']\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 680,\n                            columnNumber: 85\n                          }, this), emp.calculated_drop_time && /*#__PURE__*/_jsxDEV(_Fragment, {\n                            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                                src: \"/Images/3859125_app_hour_interface_time_timer_icon.png\",\n                                className: \"clock-icon\"\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 683,\n                                columnNumber: 96\n                              }, this), \"Drop Time: \", editable[editKey] ? /*#__PURE__*/_jsxDEV(TimePicker, {\n                                onChange: val => updateEmployeeValue(dropTime, clusterId, idx, 'calculated_drop_time', val + ':00'),\n                                value: getValidTime(emp.calculated_drop_time),\n                                disableClock: true,\n                                format: \"HH:mm\",\n                                clearIcon: null,\n                                locale: \"en-GB\"\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 685,\n                                columnNumber: 101\n                              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                                children: emp.calculated_drop_time || 'N/A'\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 693,\n                                columnNumber: 101\n                              }, this)]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 683,\n                              columnNumber: 93\n                            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                              children: [\"\\uD83D\\uDE97 Sequence: \", editable[editKey] ? /*#__PURE__*/_jsxDEV(\"input\", {\n                                type: \"number\",\n                                min: \"1\",\n                                value: emp.drop_sequence || '',\n                                onChange: e => updateEmployeeValue(dropTime, clusterId, idx, 'drop_sequence', parseInt(e.target.value, 10))\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 696,\n                                columnNumber: 97\n                              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                                className: \"drop-seqence\",\n                                children: emp.drop_sequence || 'N/A'\n                              }, void 0, false, {\n                                fileName: _jsxFileName,\n                                lineNumber: 698,\n                                columnNumber: 97\n                              }, this)]\n                            }, void 0, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 695,\n                              columnNumber: 93\n                            }, this)]\n                          }, void 0, true), /*#__PURE__*/_jsxDEV(\"button\", {\n                            onClick: () => toggleEdit(dropTime, clusterId, idx),\n                            children: editable[editKey] ? 'Save' : 'Edit'\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 701,\n                            columnNumber: 85\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 678,\n                          columnNumber: 81\n                        }, this)\n                      }, emp.employee_id, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 676,\n                        columnNumber: 73\n                      }, this);\n                    }), provided.placeholder]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 574,\n                    columnNumber: 61\n                  }, this)\n                }, `${dropTime}__${clusterId}`, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 572,\n                  columnNumber: 53\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 564,\n              columnNumber: 41\n            }, this)]\n          }, dropTime, true, {\n            fileName: _jsxFileName,\n            lineNumber: 557,\n            columnNumber: 37\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 526,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 519,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 508,\n    columnNumber: 9\n  }, this);\n};\n_s(DropGroupingSchedules, \"4FlKLTvhx4GIxYEK6jIctrrTDSk=\");\n_c2 = DropGroupingSchedules;\nexport default DropGroupingSchedules;\nvar _c, _c2;\n$RefreshReg$(_c, \"StatsCard\");\n$RefreshReg$(_c2, \"DropGroupingSchedules\");","map":{"version":3,"names":["React","useCallback","useEffect","useState","useRef","ApiComponent","DatePicker","DragDropContext","Droppable","Draggable","FaPlus","FaArrowRight","IoCheckmarkCircleOutline","TimePicker","Dropdown","ClusterMapModal","ToastComponent","TrendingUp","TrendingDown","DollarSign","Users","FileText","CheckCircle","Bus","jsxDEV","_jsxDEV","Fragment","_Fragment","StatsCard","label","value","icon","color","footer","trend","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","DropGroupingSchedules","_s","info","error","success","manualClusters","setManualClusters","selectedDate","setSelectedDate","Date","apiProps","setApiProps","editable","setEditable","vechilesList","setVechileList","mapClusterData","setMapClusterData","routingStatus","setRoutingStatus","prevManualClustersRef","prevManualClusters","current","JSON","stringify","groupedByDate","Map","Object","entries","forEach","dropTime","clusters","clusterId","cluster","_employeeList$","employeeList","shiftDate","shift_date","has","set","Set","get","add","dropTimesSet","dropTimes","Array","from","fetchRoutingDetails","method","url","postData","drop_time","render","detailsResponse","status","isArray","data","allRoutingData","filter","item","routing","includes","drop_trip_status","length","updatedClusters","newRoutingStatus","clustersToRemove","_item$vehicle","_item$vehicle2","_item$vehicle3","group","schedule","cluster_id","vehicleNumber","vehicle","vechile_number","vechile_id","vehicleOwnerName","vechile_owner_name","currentCluster","vehicleDetails","employees","clusterKey","split","keys","prev","fetchSchedules","fetchVehicleList","date","onComplete","formattedDate","toISOString","response","optimizedRoutes","optimized_routes","initialClusters","route","drop_time_group","cl","idx","drop_sequence","routeName","route_name","console","onError","saveClusterChanges","empIndex","_cluster$employeeList","employee","calculated_drop_time","distance_from_last","cumulative_distance","payload","employee_id","schedule_id","message","addNewCluster","newClusterId","handleProceed","postCluster","_cluster$employeeList2","result","updated","newRoute","find","r","tripStatus","trip_status","warn","onDragEnd","source","destination","droppableId","index","sourceTime","sourceCluster","destTime","destCluster","sourceItems","destItems","movedItem","splice","some","emp","isoDate","updateEmployeeValue","key","toggleEdit","wasEditing","getValidTime","timeStr","match","totalRoutes","reduce","acc","totalEmployees","values","clusterAcc","clusterData","_clusterData$employee","onClose","selected","onChange","src","alt","sort","timeA","timeB","tA","padStart","tB","localeCompare","map","total","_clusterData$employee2","onClick","isOptimized","provided","ref","innerRef","droppableProps","size","options","option","htmlFor","id","e","selectedValue","target","trim","selectedVehicle","v","vehicle_id","_employeeList$2","onFocus","currentValue","setTimeout","placeholder","name","dropDownList","disabled","join","editKey","draggableId","draggableProps","dragHandleProps","employee_name","employee_address","val","disableClock","format","clearIcon","locale","type","min","parseInt","_c2","$RefreshReg$"],"sources":["C:/Users/annavarapu.7/Transport-frontend/src/Pages/Schedules/DropGroupingSchedules.js"],"sourcesContent":["import React, { useCallback, useEffect, useState, useRef } from 'react';\r\nimport ApiComponent from '../../Components/API';\r\nimport DatePicker from 'react-datepicker';\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\r\nimport { FaPlus, FaArrowRight } from 'react-icons/fa';\r\nimport { IoCheckmarkCircleOutline } from 'react-icons/io5';\r\nimport TimePicker from 'react-time-picker';\r\nimport Dropdown from '../../Components/Dropdown';\r\nimport ClusterMapModal from '../../Components/ClusterMapModel';\r\nimport ToastComponent from '../../Components/Toast';\r\nimport 'react-datepicker/dist/react-datepicker.css';\r\nimport 'react-time-picker/dist/TimePicker.css';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport {\r\n    TrendingUp,\r\n    TrendingDown,\r\n    DollarSign,\r\n    Users,\r\n    FileText,\r\n    CheckCircle,\r\n    Bus,\r\n} from 'lucide-react';\r\n\r\n\r\nconst StatsCard = ({ label, value, icon, color, footer, trend }) => (\r\n    <div className=\"stats-card\">\r\n        <div className=\"card-top\">\r\n            <div>\r\n                <p className=\"card-label\">{label}</p>\r\n                <p className=\"card-value\">{value}</p>\r\n            </div>\r\n            <div className={`icon-container ${color}`}>{icon}</div>\r\n        </div>\r\n        {/* {footer && (\r\n      <div className=\"card-footer\">\r\n        {trend === 'up' && <TrendingUp className=\"trend-icon green\" />}\r\n        {trend === 'down' && <TrendingDown className=\"trend-icon red\" />}\r\n        <span className={`trend-value ${trend === 'up' ? 'green' : 'red'}`}>\r\n          {footer.split(' ')[0]}\r\n        </span>\r\n        <span className=\"trend-text\">{footer.split(' ').slice(1).join(' ')}</span>\r\n      </div>\r\n    )} */}\r\n    </div>\r\n);\r\n\r\nconst DropGroupingSchedules = () => {\r\n    const { info, error, success } = ToastComponent();\r\n    const [manualClusters, setManualClusters] = useState({});\r\n    const [selectedDate, setSelectedDate] = useState(() => new Date());\r\n    const [apiProps, setApiProps] = useState(null);\r\n    const [editable, setEditable] = useState({});\r\n    const [vechilesList, setVechileList] = useState([]);\r\n    const [mapClusterData, setMapClusterData] = useState(null);\r\n    const [routingStatus, setRoutingStatus] = useState({});\r\n    const prevManualClustersRef = useRef();\r\n\r\n\r\n    useEffect(() => {\r\n        const prevManualClusters = prevManualClustersRef.current;\r\n        if (prevManualClusters && JSON.stringify(prevManualClusters) !== JSON.stringify(manualClusters)) {\r\n            const groupedByDate = new Map(); // Map<shiftDate, Set<pickupTime>>\r\n\r\n            Object.entries(manualClusters).forEach(([dropTime, clusters]) => {\r\n                Object.entries(clusters).forEach(([clusterId, cluster]) => {\r\n                    const employeeList = cluster.employeeList;\r\n                    const shiftDate = employeeList && employeeList[0]?.shift_date;\r\n\r\n                    if (shiftDate) {\r\n                        if (!groupedByDate.has(shiftDate)) {\r\n                            groupedByDate.set(shiftDate, new Set());\r\n                        }\r\n                        groupedByDate.get(shiftDate).add(dropTime);\r\n                    }\r\n                });\r\n            });\r\n\r\n            // Send one request per shift date with all its pickup times\r\n            groupedByDate.forEach((dropTimesSet, shiftDate) => {\r\n                const dropTimes = Array.from(dropTimesSet);\r\n                fetchRoutingDetails(dropTimes, shiftDate);\r\n            });\r\n        }\r\n        prevManualClustersRef.current = manualClusters;\r\n    }, [manualClusters]);\r\n\r\n\r\n    const fetchRoutingDetails = (dropTimes, shiftDate) => {\r\n        setApiProps({\r\n            method: 'POST',\r\n            url: 'api/get/drop/routing-details',\r\n            postData: JSON.stringify({\r\n                drop_time: dropTimes,  // Now an array\r\n                shift_date: shiftDate\r\n            }),\r\n            render: (detailsResponse) => {\r\n                if (detailsResponse.status === 200 && Array.isArray(detailsResponse.data.data)) {\r\n\r\n                    // Filter for both 'Routing Done', 'Picked Up', and 'Completed' statuses\r\n                    const allRoutingData = detailsResponse.data.data.filter(item =>\r\n                        item.routing && ['Routing Done', 'Picked Up', 'Completed'].includes(item.routing.drop_trip_status)\r\n                    );\r\n\r\n                    if (allRoutingData.length > 0) {\r\n                        setManualClusters(prevManualClusters => {\r\n                            const updatedClusters = { ...prevManualClusters };\r\n                            const newRoutingStatus = {};\r\n                            const clustersToRemove = new Set(); // To track clusters to be removed\r\n\r\n                            allRoutingData.forEach(item => {\r\n                                const group = item.schedule.drop_time; // drop_time is the group\r\n                                const clusterId = item.cluster_id;\r\n                                const vehicleNumber = item?.vehicle?.vechile_number || null;\r\n                                const vechile_id = item?.vehicle?.vechile_id || null;\r\n                                const vehicleOwnerName = item?.vehicle?.vechile_owner_name || null;\r\n                                const employeeList = item.employeeList || []; // Assuming the employee list is in the API response\r\n                                const status = item.routing.drop_trip_status; // Either 'Routing Done', 'Picked Up', or 'Completed'\r\n\r\n                                // Check if the cluster and group already exist in the state\r\n                                if (updatedClusters[group] && updatedClusters[group][clusterId]) {\r\n                                    const currentCluster = updatedClusters[group][clusterId];\r\n\r\n                                    // Add vehicle details if they are not already set\r\n                                    if (\r\n                                        vehicleNumber &&\r\n                                        (!currentCluster.vehicleDetails || currentCluster.vehicleDetails.vechile_number !== vehicleNumber)\r\n                                    ) {\r\n                                        currentCluster.vehicleDetails = {\r\n                                            vechile_number: vehicleNumber,\r\n                                            vechile_owner_name: vehicleOwnerName,\r\n                                            vechile_id: vechile_id\r\n                                        };\r\n                                    }\r\n\r\n                                    // Replace the current employees with the new employeeList\r\n                                    if (Array.isArray(employeeList) && employeeList.length > 0) {\r\n                                        currentCluster.employees = employeeList; // Replace employees with employeeList from the API\r\n                                    }\r\n\r\n                                    // Set routing status to either 'completed' or 'routing done', or 'Trip in progress' for 'Picked Up'\r\n                                    if (status === 'Completed') {\r\n                                        newRoutingStatus[`${group}__${clusterId}`] = 'completed';\r\n                                    } else if (status === 'Picked Up') {\r\n                                        newRoutingStatus[`${group}__${clusterId}`] = 'Trip in progress'; // Update here\r\n                                    } else {\r\n                                        newRoutingStatus[`${group}__${clusterId}`] = 'routing done';\r\n                                    }\r\n\r\n                                    // If the status is 'Completed', we need to mark this cluster for removal\r\n                                    if (status === 'Completed') {\r\n                                        clustersToRemove.add(`${group}__${clusterId}`);\r\n                                    }\r\n                                }\r\n                            });\r\n\r\n                            // Remove the clusters that are marked for removal\r\n                            clustersToRemove.forEach(clusterKey => {\r\n                                const [dropTime, clusterId] = clusterKey.split('__');\r\n                                if (updatedClusters[dropTime] && updatedClusters[dropTime][clusterId]) {\r\n                                    delete updatedClusters[dropTime][clusterId];\r\n\r\n                                    // If the pickup group has no clusters left, delete the entire pickup group\r\n                                    if (Object.keys(updatedClusters[dropTime]).length === 0) {\r\n                                        delete updatedClusters[dropTime];\r\n                                    }\r\n                                }\r\n                            });\r\n\r\n                            // Filter out any pickup groups that are empty (i.e., they don't have any clusters after removal)\r\n                            Object.keys(updatedClusters).forEach(group => {\r\n                                if (Object.keys(updatedClusters[group]).length === 0) {\r\n                                    delete updatedClusters[group]; // Remove the empty pickup group\r\n                                }\r\n                            });\r\n\r\n                            // Update routing status\r\n                            setRoutingStatus(prev => ({\r\n                                ...prev,\r\n                                ...newRoutingStatus\r\n                            }));\r\n\r\n                            // Return the updated clusters after filtering out empty groups\r\n                            return updatedClusters;\r\n                        });\r\n                    } else {\r\n                        // Handle case where no routing data is available\r\n                        // info('No routing data found for the selected date.');\r\n                    }\r\n                } else {\r\n                    error(\"Failed to fetch routing details.\");\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n\r\n    // Fetch schedules on date change\r\n    useEffect(() => {\r\n        if (selectedDate) {\r\n            fetchSchedules(selectedDate, () => {\r\n                fetchVehicleList();\r\n            });\r\n        }\r\n    }, [selectedDate]);\r\n\r\n    const fetchSchedules = (date, onComplete) => {\r\n        const formattedDate = date.toISOString().split('T')[0];\r\n\r\n        setApiProps({\r\n            method: 'POST',\r\n            url: 'api/get/drop/clustered-routes',\r\n            postData: { date: formattedDate },\r\n            render: (response) => {\r\n                const optimizedRoutes = response.data.optimized_routes || [];\r\n                const initialClusters = {};\r\n                optimizedRoutes.forEach(route => {\r\n                    const dropTime = route.drop_time_group;\r\n                    const clusters = {};\r\n                    route.clusters.forEach((cl, idx) => {\r\n                        clusters[`cluster${idx + 1}`] = {\r\n                            employeeList: cl.drop_sequence,\r\n                            routeName: cl.route_name,\r\n                            vehicleDetails: null\r\n                        };\r\n                    });\r\n                    initialClusters[dropTime] = clusters;\r\n                });\r\n                setManualClusters(initialClusters);\r\n                setRoutingStatus({});\r\n                if (onComplete) onComplete(); // Trigger next step\r\n            }\r\n        });\r\n    };\r\n\r\n    // Fetch vehicle list\r\n    const fetchVehicleList = () => {\r\n        if (vechilesList.length === 0) {\r\n            setApiProps({\r\n                method: 'GET',\r\n                url: 'api/get/vechile/all',\r\n                render: (response) => {\r\n                    if (response) {\r\n                        setVechileList(response.data);\r\n                    } else {\r\n                        console.error('No response received from API');\r\n                    }\r\n                },\r\n                onError: (error) => {\r\n                    console.error('Error fetching vehicles:', error);\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    // Save cluster changes\r\n    const saveClusterChanges = (dropTime, clusterId, empIndex) => {\r\n        const cluster = manualClusters[dropTime][clusterId];\r\n\r\n        if (!cluster) {\r\n            console.error(\"Cluster not found.\");\r\n            return;\r\n        }\r\n\r\n        const shiftDate = cluster.employeeList[0]?.shift_date;\r\n        const employee = cluster.employeeList[empIndex];\r\n        if (!employee) {\r\n            console.error('Employee not found at the given index');\r\n            return;\r\n        }\r\n\r\n        // Update the relevant employee's details\r\n        cluster.employeeList[empIndex] = {\r\n            ...employee,\r\n            drop_sequence: employee.drop_sequence,  // (if modified)\r\n            calculated_drop_time: employee.calculated_drop_time,  // (if modified)\r\n            distance_from_last: employee.distance_from_last || 0,  // Handle undefined\r\n            cumulative_distance: employee.cumulative_distance || 0,  // Handle undefined\r\n        };\r\n\r\n\r\n        const payload = {\r\n            clusters: manualClusters,\r\n            date: shiftDate,\r\n        };\r\n\r\n        setApiProps({\r\n            method: 'PUT',\r\n            url: `api/get/drop/updated/manual-clustered-details/${employee.employee_id}/${employee.schedule_id}`,\r\n            postData: JSON.stringify(payload),  // Ensure the payload is stringified\r\n            render: (response) => {\r\n                if (response.status === 200) {\r\n                    success(\"Changes saved successfully.\");\r\n                    fetchRoutingDetails([dropTime], shiftDate);\r\n                } else {\r\n                    error(response?.message || \"Failed to save changes.\");\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n\r\n\r\n    // Add a new cluster to the drop time\r\n    const addNewCluster = (dropTime) => {\r\n        setManualClusters((prev) => {\r\n            const current = prev[dropTime] || {};\r\n            const newClusterId = `cluster${Object.keys(current).length + 1}`;\r\n            return {\r\n                ...prev,\r\n                [dropTime]: {\r\n                    ...current,\r\n                    [newClusterId]: {\r\n                        employeeList: [],\r\n                        vehicleDetails: null\r\n                    }\r\n                }\r\n            };\r\n        });\r\n    };\r\n\r\n\r\n    // Handle \"Optimize Routing\" button click\r\n    const handleProceed = useCallback((dropTime, clusterId) => {\r\n        const cluster = manualClusters[dropTime][clusterId];\r\n        if (!cluster.vehicleDetails) {\r\n            ToastComponent().error(\"Please select a vehicle\");\r\n            return;\r\n        }\r\n\r\n        const postCluster = {\r\n            [dropTime]: [{\r\n                ...cluster,\r\n                clusterId: clusterId\r\n            }]\r\n        };\r\n\r\n        setApiProps({\r\n            method: 'POST',\r\n            url: 'api/get/drop-routing',\r\n            postData: JSON.stringify(postCluster),\r\n            render: (response) => {\r\n                const result = response.data;\r\n\r\n                if (!result || !result.route || !Array.isArray(result.route)) {\r\n                    console.error(\"Invalid response format: 'route' array not found\", result);\r\n                    error(\"Failed to update routing. Invalid response format.\");\r\n                    return;\r\n                }\r\n\r\n                const updated = { ...manualClusters };\r\n                const newRoute = result.route.find(r => r.drop_time_group === dropTime);\r\n\r\n                if (newRoute) {\r\n                    newRoute.clusters.forEach((cl, idx) => {\r\n                        const clusterKey = Object.keys(updated[dropTime])[idx] || `cluster${idx + 1}`;\r\n                        updated[dropTime][clusterKey].employeeList = cl.drop_sequence;\r\n\r\n                        const tripStatus = cl.trip_status;\r\n                        if (tripStatus) {\r\n                            setRoutingStatus(prev => ({\r\n                                ...prev,\r\n                                [`${dropTime}__${clusterKey}`]: tripStatus\r\n                            }));\r\n                        }\r\n\r\n                        // saveClusterChanges(dropTime, clusterKey);\r\n                    });\r\n                }\r\n\r\n                setManualClusters(updated);\r\n\r\n                // âœ… Get shift_date from first employee in the cluster\r\n                const shiftDate = cluster.employeeList[0]?.shift_date;\r\n                if (shiftDate) {\r\n                    fetchRoutingDetails([dropTime], shiftDate);  // Send as list\r\n                } else {\r\n                    console.warn(\"Shift date not found in cluster data\");\r\n                }\r\n            }\r\n        });\r\n    }, [manualClusters, success, error, info]);\r\n\r\n\r\n\r\n    // Handle drag-and-drop behavior\r\n    const onDragEnd = (result) => {\r\n        const { source, destination } = result;\r\n        if (!destination || (source.droppableId === destination.droppableId && source.index === destination.index)) return;\r\n\r\n        const [sourceTime, sourceCluster] = source.droppableId.split('__');\r\n        const [destTime, destCluster] = destination.droppableId.split('__');\r\n        if (sourceTime !== destTime) return;\r\n\r\n        const sourceItems = Array.from(manualClusters[sourceTime][sourceCluster].employeeList);\r\n        const destItems = Array.from(manualClusters[destTime][destCluster].employeeList);\r\n        const [movedItem] = sourceItems.splice(source.index, 1);\r\n\r\n        // Prevent moving an employee if they already exist in the destination\r\n        if (destItems.some(emp => emp.employee_id === movedItem.employee_id)) return;\r\n\r\n        // Move the item to the destination\r\n        destItems.splice(destination.index, 0, movedItem);\r\n\r\n\r\n        // Update the clusters with the new data\r\n        const updatedClusters = {\r\n            ...manualClusters,\r\n            [sourceTime]: {\r\n                ...manualClusters[sourceTime],\r\n                [sourceCluster]: {\r\n                    ...manualClusters[sourceTime][sourceCluster],\r\n                    employeeList: sourceItems\r\n                },\r\n                [destCluster]: {\r\n                    ...manualClusters[destTime][destCluster],\r\n                    employeeList: destItems\r\n                }\r\n            }\r\n        };\r\n\r\n        // Remove any empty clusters before sending the data to the API\r\n        Object.keys(updatedClusters[sourceTime]).forEach(cluster => {\r\n            if (updatedClusters[sourceTime][cluster].employeeList.length === 0) {\r\n                delete updatedClusters[sourceTime][cluster];\r\n            }\r\n        });\r\n        Object.keys(updatedClusters[destTime]).forEach(cluster => {\r\n            if (updatedClusters[destTime][cluster].employeeList.length === 0) {\r\n                delete updatedClusters[destTime][cluster];\r\n            }\r\n        });\r\n\r\n        setManualClusters(updatedClusters);\r\n\r\n        // Update routing status\r\n        setRoutingStatus(prev => ({\r\n            ...prev,\r\n            [`${sourceTime}__${sourceCluster}`]: false,\r\n            [`${destTime}__${destCluster}`]: false\r\n        }));\r\n\r\n        const shiftDate = movedItem?.shift_date || new Date().toISOString().split(\"T\")[0];\r\n        const isoDate = `${shiftDate}T${sourceTime}`;\r\n\r\n        const payload = {\r\n            clusters: updatedClusters,\r\n            date: isoDate, // Correct ISO 8601 format\r\n        };\r\n\r\n        // Call the API to save the updated clusters\r\n        setApiProps({\r\n            method: 'POST',\r\n            url: 'api/get/drop/updated/manual-clustered-routes',\r\n            postData: JSON.stringify(payload),  // Ensure payload is stringified\r\n            render: (response) => {\r\n                if (response.status === 200) {\r\n                    success(\"Saved successfully.\");\r\n                    fetchSchedules(shiftDate);\r\n                } else {\r\n                    error(response?.message || \"Failed to save changes.\");\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n\r\n    // Update employee values\r\n    const updateEmployeeValue = (dropTime, clusterId, empIndex, key, value) => {\r\n        setManualClusters(prev => {\r\n            const updated = { ...prev };\r\n            const cluster = [...updated[dropTime][clusterId].employeeList];\r\n            cluster[empIndex][key] = value;\r\n            updated[dropTime][clusterId].employeeList = cluster;\r\n            return updated;\r\n        });\r\n    };\r\n\r\n    const toggleEdit = (dropTime, clusterId, empIndex) => {\r\n        const key = `${dropTime}__${clusterId}__${empIndex}`;\r\n        const wasEditing = editable[key];\r\n        setEditable(prev => ({ ...prev, [key]: !prev[key] }));\r\n        if (wasEditing === true) {\r\n            saveClusterChanges(dropTime, clusterId, empIndex);\r\n        }\r\n    };\r\n\r\n    const getValidTime = (timeStr) => {\r\n        if (!timeStr || typeof timeStr !== 'string') return '00:00';\r\n        const match = timeStr.match(/^(\\d{2}):(\\d{2})/);\r\n        return match ? match[0] : '00:00';\r\n    };\r\n\r\n\r\n\r\n    const totalRoutes = Object.keys(manualClusters).reduce((acc, dropTime) => {\r\n        return acc + Object.keys(manualClusters[dropTime]).length;\r\n    }, 0);\r\n\r\n    const totalEmployees = Object.values(manualClusters).reduce((acc, clusters) => {\r\n        return acc + Object.values(clusters).reduce((clusterAcc, clusterData) => {\r\n            return clusterAcc + (clusterData?.employeeList?.length || 0);\r\n        }, 0);\r\n    }, 0);\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"pick-grouping-main-container\">\r\n            {apiProps && <ApiComponent {...apiProps} />}\r\n            {mapClusterData && <ClusterMapModal clusterData={mapClusterData} onClose={() => setMapClusterData(null)} />}\r\n            <div className=\"grouping-schediles-with-datepicker-container\">\r\n                <h2>Drop Schedules</h2>\r\n                <DatePicker\r\n                    selected={selectedDate}\r\n                    onChange={date => { if (date) setSelectedDate(date); }}\r\n                    className=\"date-range-picker\"\r\n                />\r\n            </div>\r\n            <DragDropContext onDragEnd={onDragEnd}>\r\n                {Object.keys(manualClusters).length === 0 ? (\r\n                    <div className=\"no-schedules-message\">\r\n                        <img src='/Images/897245_clock_manage_schedule_time_icon.png' alt='schedule' />\r\n                        <p>No schedules available.</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grouped-schedules-list\">\r\n                        <div className=\"stats-grid\">\r\n                            <StatsCard\r\n                                label=\"Total Routes\"\r\n                                value={totalRoutes}\r\n                                icon={<Bus className=\"icon green\" />}\r\n                                color=\"green-bg\"\r\n                            />\r\n                            <StatsCard\r\n                                label=\"Total Employees\"\r\n                                value={totalEmployees}\r\n                                icon={<Users className=\"icon blue\" />}\r\n                                color=\"green-bg\"\r\n                            />\r\n                        </div>\r\n                        {Object.entries(manualClusters)\r\n                            .sort(([timeA], [timeB]) => {\r\n                                const tA = timeA.padStart(5, '0');\r\n                                const tB = timeB.padStart(5, '0');\r\n                                return tA.localeCompare(tB);\r\n                            })\r\n                            .map(([dropTime, clusters]) => {\r\n                                const totalRoutes = Object.keys(clusters).length;\r\n                                const totalEmployees = Object.values(clusters).reduce(\r\n                                    (total, clusterData) =>\r\n                                        total +\r\n                                        (clusterData?.employeeList?.length || 0),\r\n                                    0\r\n                                );\r\n\r\n                                return (\r\n                                    <div className=\"pickuptime-group\" key={dropTime}>\r\n                                        <div className=\"pickuptime-with-actions\">\r\n                                            <h4>Drop Time: {dropTime}</h4>\r\n                                            <h5>Total Routes: {totalRoutes}</h5>\r\n                                            <h5>Total Employees: {totalEmployees}</h5>\r\n                                            <button onClick={() => addNewCluster(dropTime)} className=\"add-cluster-btn\"><FaPlus /> Add Cluster</button>\r\n                                        </div>\r\n                                        <div className=\"clusters-container\">\r\n                                            {Object.entries(clusters).map(([clusterId, clusterData]) => {\r\n                                                const employeeList = clusterData?.employeeList || [];\r\n                                                const routeName = clusterData?.routeName || '';\r\n                                                const vehicleDetails = clusterData?.vehicleDetails;\r\n                                                const isOptimized = routingStatus[`${dropTime}__${clusterId}`];\r\n\r\n                                                return (\r\n                                                    <Droppable droppableId={`${dropTime}__${clusterId}`} key={`${dropTime}__${clusterId}`}>\r\n                                                        {(provided) => (\r\n                                                            <div className=\"cluster-card\" ref={provided.innerRef} {...provided.droppableProps}>\r\n                                                                <div className=\"cluster-card-with-vechile\">\r\n                                                                    <h5>{clusterId}</h5>\r\n                                                                    {isOptimized ? (\r\n                                                                        routingStatus[`${dropTime}__${clusterId}`] === 'Trip in progress' ? (\r\n                                                                            <span className=\"trip-in-progress\">Trip Started</span>\r\n                                                                        ) : (\r\n                                                                            <IoCheckmarkCircleOutline className=\"optimized-check-icon\" size={20} color=\"green\" />\r\n                                                                        )\r\n                                                                    ) : (\r\n                                                                        <button onClick={() => handleProceed(dropTime, clusterId)} className=\"optimize-routing-btn\">\r\n                                                                            <FaArrowRight /> Assign Vehicle\r\n                                                                        </button>\r\n                                                                    )}\r\n                                                                </div>\r\n                                                                <div className=\"cluster-card-with-vechile\">\r\n                                                                    <Dropdown\r\n                                                                        options={['', ...vechilesList.map(option => `${option.vechile_number} - ${option.vechile_owner_name}`)]}\r\n                                                                        key={vechilesList.map(option => option.vechile_id).join('-')}\r\n                                                                        className=\"vechile-dropdown\"\r\n                                                                        htmlFor=\"vechile\"\r\n                                                                        id=\"vechile\"\r\n                                                                        label=\"\"\r\n                                                                        value={vehicleDetails ? `${vehicleDetails.vechile_number} - ${vehicleDetails.vechile_owner_name}` : ''}\r\n                                                                        onChange={(e) => {\r\n                                                                            const selectedValue = e.target.value.trim();\r\n                                                                            if (selectedValue === '') {\r\n                                                                                setManualClusters(prev => ({\r\n                                                                                    ...prev,\r\n                                                                                    [dropTime]: {\r\n                                                                                        ...prev[dropTime],\r\n                                                                                        [clusterId]: {\r\n                                                                                            ...prev[dropTime][clusterId],\r\n                                                                                            vehicleDetails: null\r\n                                                                                        }\r\n                                                                                    }\r\n                                                                                }));\r\n                                                                                return;\r\n                                                                            }\r\n                                                                            const selectedVehicle = vechilesList.find(v => `${v.vechile_number} - ${v.vechile_owner_name}` === selectedValue);\r\n                                                                            if (selectedVehicle && (!vehicleDetails || selectedVehicle.vechile_id !== vehicleDetails.vechile_id)) {\r\n                                                                                setManualClusters(prev => ({\r\n                                                                                    ...prev,\r\n                                                                                    [dropTime]: {\r\n                                                                                        ...prev[dropTime],\r\n                                                                                        [clusterId]: {\r\n                                                                                            ...prev[dropTime][clusterId],\r\n                                                                                            vehicleDetails: selectedVehicle\r\n                                                                                        }\r\n                                                                                    }\r\n                                                                                }));\r\n                                                                                const payload = employeeList.map(employee => ({\r\n                                                                                    vehicle_id: selectedVehicle.id,\r\n                                                                                    employee_id: employee.employee_id,\r\n                                                                                    schedule_id: employee.schedule_id\r\n                                                                                }));\r\n                                                                                if (payload.length === 0) {\r\n                                                                                    console.error('No employees in the cluster.');\r\n                                                                                    return;\r\n                                                                                }\r\n                                                                                setApiProps({\r\n                                                                                    method: 'POST',\r\n                                                                                    url: 'api/update/drop-vehicles',\r\n                                                                                    postData: JSON.stringify(payload),\r\n                                                                                    render: (response) => {\r\n                                                                                        if (response.status === 200) {\r\n                                                                                            success(\"Vehicles updated for all employees in the cluster.\");\r\n                                                                                            fetchRoutingDetails([dropTime], employeeList[0]?.shift_date);\r\n                                                                                        } else {\r\n                                                                                            error(response?.message || \"Failed to update vehicles.\");\r\n                                                                                        }\r\n                                                                                    }\r\n                                                                                });\r\n                                                                            }\r\n                                                                        }}\r\n                                                                        onFocus={(e) => {\r\n                                                                            const currentValue = e.target.value;\r\n                                                                            e.target.value = '';\r\n                                                                            setTimeout(() => {\r\n                                                                                e.target.value = currentValue;\r\n                                                                            }, 0);\r\n                                                                        }}\r\n                                                                        placeholder=\"Vehicle No\"\r\n                                                                        name=\"vechileNo\"\r\n                                                                        dropDownList=\"vechilesList\"\r\n                                                                        disabled={!editable[`${dropTime}__${clusterId}`]}\r\n                                                                    />\r\n                                                                    <button onClick={() => setMapClusterData(employeeList)} disabled={employeeList.length === 0} className='view-map-button'>Map</button>\r\n                                                                </div>\r\n                                                                <div className='cluster-route-info'>\r\n                                                                    <h6>Route Name : <span>{routeName}</span></h6>\r\n                                                                </div>\r\n                                                                {employeeList.length === 0 && (\r\n                                                                    <button onClick={() => {\r\n                                                                        const updated = { ...manualClusters };\r\n                                                                        delete updated[dropTime][clusterId];\r\n                                                                        setManualClusters(updated);\r\n                                                                    }} className=\"remove-cluster-btn\">âœ•</button>\r\n                                                                )}\r\n                                                                {employeeList.map((emp, idx) => {\r\n                                                                    const editKey = `${dropTime}__${clusterId}__${idx}`;\r\n                                                                    return (\r\n                                                                        <Draggable key={emp.employee_id} draggableId={emp.employee_id} index={idx}>\r\n                                                                            {(provided) => (\r\n                                                                                <div className=\"employee-card\" ref={provided.innerRef} {...provided.draggableProps} {...provided.dragHandleProps}>\r\n                                                                                    <p><strong>{emp.employee_name || 'Unnamed'}</strong></p>\r\n                                                                                    <p><img src='/Images/5172573_location_map_icon.png' className='location-icon' />{emp.employee_address || 'No address'}</p>\r\n                                                                                    {emp.calculated_drop_time && (\r\n                                                                                        <>\r\n                                                                                            <p><img src='/Images/3859125_app_hour_interface_time_timer_icon.png' className='clock-icon' />\r\n                                                                                                Drop Time: {editable[editKey] ? (\r\n                                                                                                    <TimePicker\r\n                                                                                                        onChange={(val) => updateEmployeeValue(dropTime, clusterId, idx, 'calculated_drop_time', val + ':00')}\r\n                                                                                                        value={getValidTime(emp.calculated_drop_time)}\r\n                                                                                                        disableClock\r\n                                                                                                        format=\"HH:mm\"\r\n                                                                                                        clearIcon={null}\r\n                                                                                                        locale=\"en-GB\"\r\n                                                                                                    />\r\n                                                                                                ) : <span>{emp.calculated_drop_time || 'N/A'}</span>}\r\n                                                                                            </p>\r\n                                                                                            <p>ðŸš— Sequence: {editable[editKey] ? (\r\n                                                                                                <input type=\"number\" min=\"1\" value={emp.drop_sequence || ''} onChange={(e) =>\r\n                                                                                                    updateEmployeeValue(dropTime, clusterId, idx, 'drop_sequence', parseInt(e.target.value, 10))} />\r\n                                                                                            ) : <span className='drop-seqence'>{emp.drop_sequence || 'N/A'}</span>}</p>\r\n                                                                                        </>\r\n                                                                                    )}\r\n                                                                                    <button onClick={() => toggleEdit(dropTime, clusterId, idx)}>{editable[editKey] ? 'Save' : 'Edit'}</button>\r\n                                                                                </div>\r\n                                                                            )}\r\n                                                                        </Draggable>\r\n                                                                    );\r\n                                                                })}\r\n                                                                {provided.placeholder}\r\n                                                            </div>\r\n                                                        )}\r\n                                                    </Droppable>\r\n                                                );\r\n                                            })}\r\n                                        </div>\r\n                                    </div>\r\n                                )\r\n                            })}\r\n                    </div>\r\n                )}\r\n            </DragDropContext>\r\n        </div>\r\n\r\n    );\r\n};\r\n\r\nexport default DropGroupingSchedules;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}